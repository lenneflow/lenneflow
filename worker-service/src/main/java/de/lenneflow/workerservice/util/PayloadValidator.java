package de.lenneflow.workerservice.util;

import de.lenneflow.workerservice.exception.InternalServiceException;
import de.lenneflow.workerservice.exception.PayloadNotValidException;
import de.lenneflow.workerservice.model.LocalCluster;
import de.lenneflow.workerservice.repository.WorkerRepository;
import org.springframework.stereotype.Component;

@Component
public class PayloadValidator {

    final
    WorkerRepository workerRepository;

    public PayloadValidator(WorkerRepository workerRepository) {
        this.workerRepository = workerRepository;
    }

    public void validate(LocalCluster localCluster) {
        checkMandatoryFields(localCluster);

    }

    private void checkMandatoryFields(LocalCluster localCluster) {
        if(localCluster.getName() == null || localCluster.getName().isEmpty()) {
            throw new PayloadNotValidException("LocalCluster Name is required");
        }
        if(localCluster.getHostName() == null || localCluster.getHostName().isEmpty()) {
            throw new PayloadNotValidException("Host Name is required");
        }
        if(localCluster.getIpAddress() == null || localCluster.getIpAddress().isEmpty()) {
            throw new PayloadNotValidException("IP Address is required");
        }
        if(localCluster.getUid() == null || localCluster.getUid().isEmpty()) {
            throw new InternalServiceException("Uuid was not generated by the system");
        }
    }

}
